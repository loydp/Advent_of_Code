Should be redone before doing it in another language. This took 5 seconds to calculate in python.

Probably calculate all scores from the bottom up, maybe adding them at the same time.